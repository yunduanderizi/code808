#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <string>
#include <time.h>
#include <sys/ioctl.h>
#include <linux/rtc.h> 
#include <iostream> 

#include "VDRTrackInfoTable.h"
#include "GeneralTimer.h"
#include "Utility.h"
using namespace std;
#define TABLE_NAME "locstatus2.db"
int speed = 0;
int flag = 0;
int total_mileage = 0;

VDRLocStatus1Table loc1table;
VDRLocStatus2Table loc2table;
int speed_count = 0;
int status_count = 0;
int height_count = 0;
int now_sp = 0;
int now_st = 0;
int now_he = 0;

unsigned char speed_buf[]={0,0,0,0,0,0,1,3,4,5,7,8,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
    10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
    10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
    10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,
    10,10,10,10,10,10,12,15,16,18,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
    20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
    20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
    20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
    20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,
    20,20,20,22,24,26,28,29,30,33,35,38,40,39,40,41,42,40,40,41,42,41,40,40,40,40,40,41,41,41,40,40,40,40,40,40,40,40,40,40,40,
    40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,
    40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,
    40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,
    40,40,44,46,47,48,50,50,51,52,50,53,52,51,50,50,51,51,51,52,52,52,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
    56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
    56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
    56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,60,63,60,63,62,67,69,70,71,
    67,69,70,71,75,78,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,
    80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,
    80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,
    80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,82,85,83,82,82,82,85,85,83,82,82,82,85,85,83,82,82,82,85,80,
    80,80,81,82,80,80,83,86,87,88,85,84,85,84,82,83,86,87,89,89,89,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,
    90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,
    90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,
    90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,92,92,92,95,100,100,100,100,100,
    100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
    100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
    100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,
    100,100,100,100,100,100,100,100,100,100,100,100,101,99,99,99,100,100,100,100,101,103,101,102,102,104,105,106,106,106,108,109,
    110,109,110,112,113,115,116,118,120,121,122,124,126,127,129,130,132,135,138,140,141,145,148,149,150,152,154,155,155,157,158,
    158,160,162,165,168,169,171,173,175,179,180,180,182,185,187,189,190,193,195,197,198,199,200,203,205,207,209,211,213,216,218,
    219,220,220,220,218,215,213,210,208,204,201,198,194,190,189,186,182,180,178,174,170,168,164,165,162,160,158,155,151,151,150,
    148,147,146,142,139,137,135,132,129,126,123,120,119,117,114,111,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,
    110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,
    110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,
    110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,
    110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,110,
    110,110,109,107,105,103,101,98,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,
    95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,
    95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,
    95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,94,90,90,90,90,91,92,90,
    85,85,85,86,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
    85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
    85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
    85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
    85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,
    85,85,85,83,82,80,80,80,80,80,78,74,72,69,65,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,57,55,52,51,51,51,50,49,48,47,45,43,
    41,36,33,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,
    30,30,30,30,28,25,23,20,16,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
    15,15,15,15,15,15,15,15,15,15,15,15,14,13,12,11,10,10,10,10,8,7,6,5,4,1,0,0,0,0,};
unsigned char status_buf[]={0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x00,0x00,0x40,
    0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x02,
    0x02,0x02,0x10,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x00,0x00,0x00,0x18,0x18,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x00,0x00,0x00,0x10,0x10,0x50,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x58,
    0x58,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x10,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x20,0x20,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x18,0x18,0x18,0x00,0x00,0x00,0x00,0x40,0x40,0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,
    0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x02,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x40,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x40,0x40,0x40,0x40,0x20,0x20,0x20,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x58,0x58,0x50,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x08,0x00,0x00,0x40,0x40,0x00,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x28,0x28,
    0x48,0x48,0x48,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,
    0x10,0x10,0x10,0x10,0x00,0x10,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x38,0x38,0x38,0x18,0x18,0x18,0x18,0x08,0x08,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x20,0x20,0x20,0x08,0x28,0x28,0x28,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x10,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x10,0x10,0x40,0x40,0x00,0x00,0x00,0x00,0x00,0x00,
    0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x30,0x30,0x30,0x30,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};

unsigned char height_buf[]={50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,
    50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,
    51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,
    52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,
    55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,
    55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,57,58,58,58,58,58,58,58,58,58,
    58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,
    58,58,58,58,58,58,58,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,
    60,60,60,60,60,60,60,60,60,60,60,60,60,59,59,59,59,58,58,58,58,57,57,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
    56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,
    56,56,56,55,54,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,
    53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,
    53,53,52,51,50,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,
    49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,
    49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,48,48,47,47,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,
    46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,
    45,44,43,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,
    42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,41,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,
    40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,39,38,37,38,38,38,38,38,38,38,38,38,
    38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,
    38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,
    39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,
    39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,
    41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,
    41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,
    43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,45,46,47,47,47,47,47,47,47,47,47,47,
    47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,49,50,50,50,50};

int execute(sqlite3 *db, const char* sql, ...)
{
	int rc;
	char *err, *tmp;
	va_list ap;

    va_start(ap, sql);
    tmp = sqlite3_vmprintf(sql, ap);
    va_end(ap);

    rc = sqlite3_exec(db, tmp, NULL, NULL, &err);

    if(rc != SQLITE_OK) {
        if (err != NULL) {
            fprintf(stderr, "execute() Error: %s\n", err);
            sqlite3_free(err);
        }
    }

    sqlite3_free(tmp);

    return rc;
}
string name;
sqlite3 *db;
void write_track_locstatus_table1(int type, int itime,int fx, int fy, int count)
{
    char *zErr;
    int rc;
    string sql;
    string tmp;
    char str[32];
    ostringstream oss;
   char command[1024]={0}; 

    static int i=0;
    int num1 = i%100;
    int num = i++/100;
    float distance = 0;
    if( num1 ==0 ){
	    oss << num;
	    name= TABLE_NAME + oss.str();
	    cout <<"name is ----------"<< name.c_str()<<endl;
	    rc = sqlite3_open(name.c_str(), &db);
	    tmp = "CREATE TABLE locstatus2"+oss.str();
	    sql = tmp + "(ColOccurTime INTEGER NOT NULL, \
		  ColAlarmSignal INTEGER NOT NULL, \
		  ColStatusFlag INTEGER NOT NULL, \
		  ColLatitude INTEGER NOT NULL, \
		  ColLongitude INTEGER NOT NULL, \
		  ColAltitude INTEGER NOT NULL, \
		  ColOrientation INTEGER NOT NULL , \
		  ColGPSSpeed INTEGER NOT NULL, \
		  ColTotalMileage INTEGER NOT NULL, \
		  ColOilMass INTEGER NOT NULL, \
		  ColVDRSpeed INTEGER NOT NULL, \
		  ColVDRStatus INTEGER NOT NULL, \
		  ColVDRNewHbStatus INTEGER NOT NULL, \
		  ColVDRDistance INTEGER NOT NULL, \
		  ColOverSpeedAlarm INTEGER NOT NULL, \
		  ColOverSpeedRegionID INTEGER NOT NULL, \
		  ColInOutAlarm INTEGER NOT NULL, \
		  ColInOutRegionID INTEGER NOT NULL, \
		  ColInOutDirection INTEGER NOT NULL, \
		  ColShortLongLineID INTEGER NOT NULL, \
		  ColShortLongTime INTEGER NOT NULL, \
		  ColShortLongResult INTEGER NOT NULL, \
		  ColEmergAlarmId INTEGER NOT NULL, \
		  ColIoStatus INTEGER NOT NULL,\
		ColAnalogQuantity INTEGER NOT NULL,\
		ColWirelessIntensity INTEGER NOT NULL,\
		ColGnssSatelliteSum INTEGER NOT NULL,\
		  ColLargeTableIndex INTEGER UNIQUE NOT NULL)";
//	    cout<< sql.c_str()<<endl;

    	   rc = execute(db, sql.c_str());
	    //rc = sqlite3_exec(db, sql.c_str(), NULL, NULL, &zErr);
	    if (rc != SQLITE_OK) {
		    if (zErr != NULL) {
			    fprintf(stderr, "SQL error: %s\n", zErr);
			    sqlite3_free(zErr);
		    }
		    exit(1);
	    }
	    sqlite3_close(db);
    rc = sqlite3_open(name.c_str(), &db);
    sqlite3_exec(db, "BEGIN", NULL, NULL, &zErr);

    }

    speed = speed_buf[now_sp];    
    distance = speed/3.6;
    total_mileage += distance;

    sprintf(command,"INSERT INTO locstatus2%d(ColAlarmSignal, ColAltitude, ColAnalogQuantity, ColEmergAlarmId, ColGPSSpeed, \ 
	    ColGnssSatelliteSum, ColInOutAlarm, ColInOutDirection, ColInOutRegionID, ColIoStatus,  ColLatitude,\
	    ColLongitude, ColOccurTime, ColOilMass, ColOrientation, ColOverSpeedAlarm, ColOverSpeedRegionID, ColShortLongLineID, \
	    ColShortLongResult, ColShortLongTime, ColStatusFlag, ColTotalMileage, ColVDRDistance, ColVDRNewHbStatus, ColVDRSpeed, \
	    ColVDRStatus, ColWirelessIntensity, ColLargeTableIndex) VALUES (0, %d, 0, 0, %d, 10, 0,  0, 0, 0, %d, %d, %d, 0, %d, 0, \
             0, 0, 0, 0, %d, %d, 0, 0, %d, %d, 3, %d)", num, height_buf[now_he], speed*10, fx, fy, itime, 60+count, 786435, total_mileage/100, speed*10, status_buf[now_st], num1);
//		    cout<< name<<endl;

    if (rc != SQLITE_OK) {
    	exit(1);
        if (zErr != NULL) {
            fprintf(stderr, "SQL error: %s\n", zErr);
            sqlite3_free(zErr);
        }
    }

     rc = sqlite3_exec(db, command, NULL, NULL, &zErr);
    if (rc != SQLITE_OK) {
        if (zErr != NULL) {
            fprintf(stderr, "SQL error: %s\n", zErr);
            sqlite3_free(zErr);
        }
    	exit(1);
    }
	//usleep(250000);
    if( num1 ==99 ){
	    sqlite3_exec(db, "COMMIT", NULL, NULL, &zErr);
	    sqlite3_close(db);
    }
}

void write_track_locstatus_table(int type, int itime,int fx, int fy, int count)
{
    LargeTableBase * table;
    float distance = 0;
    
    if(type == 1)
        table = &loc1table;
    else
        table = &loc2table;

    table->SetIntValue(VDR_LOCS_OCCUR_TIME, itime);
    table->SetIntValue(VDR_LOCS_ALARM_SIGNAL, 0);
    table->SetIntValue(VDR_LOCS_STATUS_FLAG, 786435);//acc on ,定位 运营 gps bd
    table->SetIntValue(VDR_LOCS_LATITUDE, fx);
    table->SetIntValue(VDR_LOCS_LONGITUDE, fy);
    table->SetIntValue(VDR_LOCS_ALTITUDE, height_buf[now_he]);
    table->SetIntValue(VDR_LOCS_ORIENTATION, 60+count);
    table->SetIntValue(VDR_LOCS_OIL_MASS, 0);
#if 0
    if(flag==0)
        speed++;
    else
        speed--;
    
    if(speed == 120)
        flag = 1;

    if(speed == 0)
        flag = 0;
#endif
    speed = speed_buf[now_sp];    
    distance = speed/3.6;
    total_mileage += distance;
    
    table->SetIntValue(VDR_LOCS_GPS_SPEED, speed*10);    //0.1km/h    
    table->SetIntValue(VDR_LOCS_VDR_SPEED, speed*10);  //0.1km/h
    table->SetIntValue(VDR_LOCS_TOTAL_MILEAGE, total_mileage/100);  //0.1km
    table->SetIntValue(VDR_LOCS_VDR_STATUS, status_buf[now_st]);
    table->SetIntValue(VDR_LOCS_VDR_NEW_HB_STATUS, 0);
    table->SetIntValue(VDR_LOCS_VDR_DISTANCE,0); // m

    table->SetIntValue(VDR_LOCS_OVERSPEED_ALARM, 0);
    table->SetIntValue(VDR_LOCS_OVERSPEED_REGIONID, 0);
    table->SetIntValue(VDR_LOCS_INOUT_ALARM, 0);
    table->SetIntValue(VDR_LOCS_INOUT_REGIONID, 0);
    table->SetIntValue(VDR_LOCS_INOUT_DIRECTION, 0);
    table->SetIntValue(VDR_LOCS_SHORT_LONG_LINEID, 0);
    table->SetIntValue(VDR_LOCS_SHORT_LONG_TIME, 0);
    table->SetIntValue(VDR_LOCS_SHORT_LONG_RESULT, 0);
    table->SetIntValue(VDR_LOCS_EMERGENCY_ALARM_ID, 0);

    table->SetIntValue(VDR_LOCS_IO_STATUS, 0);
    table->SetIntValue(VDR_LOCS_ANALOG_QUANTITY, 0);
    table->SetIntValue(VDR_LOCS_WIRELESS_INTENSITY, 3);
    table->SetIntValue(VDR_LOCS_GNSS_SATELLITE_SUM, 10);

    table->Add();

}

int main(int argc, char * argv [ ])
{
    int type = 1;
    int itime = 1368460800;
    int icount = 0;
    
	printf("Usage: %s type itime (count) 39000000 116000000 \n\n",argv[0]);
    
	if(argc<2)
	{
		printf("argument is too less.\n");
		return -1;
	}

    type = atoi(argv[1]);
    icount = atoi(argv[3]);
    itime = atoi(argv[2]);
    
    if(type>2 || type<1)
    {
        printf(" 0<argv[1]=%d<3 .\n",type);
        return -1;
    } 
    
    if(itime < 1335830400)
        itime = 1368460800;        

    if(icount < 1)
        icount = 10;
            
    

    int fx = atoi(argv[4]); //39919524;
    int fy = atoi(argv[5]); //116000000;
    int fxy_flag = 0;
    int num = 0, at=0;
    
    printf("now: %s %d %d %d %d %d \n",argv[0], type, itime, icount, fx , fy);
    srand((int)time(0));

    speed_count = sizeof(speed_buf);
    status_count = sizeof(status_buf);
    height_count = sizeof(height_buf);
    printf("==========speed count=%d, status count=%d\n",speed_count, status_count);

    while(1)
    {
        if(now_sp >= speed_count)
            now_sp = 0;
        if(now_st >= status_count)
            now_st = 0;  
        if(now_he >= height_count)
            now_he = 0;  

        at = rand()%4; 
        
        write_track_locstatus_table(type, itime, fx, fy, at);
        if(type == 1)
        {
            itime += 1;
            fx = fx+2;
            fy = fy+2;
            now_sp++;
            now_st++;
            now_he++;
        }
        else
        {
            fx -= num;
            fy -= num;
            
            itime += 60;
            if(fy >= 117050000 || fx >= 41050000)
                fxy_flag = 1;
            
            if(fy <= 115050000 || fx <= 39000000)
                fxy_flag = 0;

            num = rand()%1000;
            
            if(fxy_flag == 0)
            {
                fx = fx + 800 + num;
                fy = fy + 800 + num;
            }
            else
            {
                fx = fx - 800 + num;
                fy = fy - 800 + num;            
            }
            now_sp=now_sp+3;
            now_st=now_st+3;
            now_he=now_he+3;
        }
        icount--;
        if(icount < 1)
        break;
//    printf("over icount=%d.........\n",icount);
    }
    printf("over icount=%d.........\n",icount);
    
    return 0;
}
